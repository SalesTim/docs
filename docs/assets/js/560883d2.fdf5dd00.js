"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[4610],{75774:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>d,frontMatter:()=>a,metadata:()=>l,toc:()=>u});var t=r(87462),s=(r(67294),r(3905)),i=r(78561);const a={},o="Architecture Overview",l={unversionedId:"hosting/architecture-overview",id:"hosting/architecture-overview",title:"Architecture Overview",description:"nBold is a multi-tier platform that relies on independent services to support high-availability and scale with ease.",source:"@site/contents/76-hosting/20-architecture-overview.md",sourceDirName:"76-hosting",slug:"/hosting/architecture-overview",permalink:"/hosting/architecture-overview",draft:!1,editUrl:"https://github.com/nboldhq/docs/tree/main/contents/76-hosting/20-architecture-overview.md",tags:[],version:"current",sidebarPosition:20,frontMatter:{},sidebar:"autoSidebar",previous:{title:"nBold Cloud vs Self-Hosted",permalink:"/hosting/cloud-vs-self-hosted"},next:{title:"Setup Guide",permalink:"/hosting/installation/"}},c={},u=[{value:"Core components",id:"core-components",level:2},{value:"Monitoring components",id:"monitoring-components",level:2},{value:"Design Principles",id:"design-principles",level:2},{value:"Security first",id:"security-first",level:3},{value:"Infrastructure as code",id:"infrastructure-as-code",level:3},{value:"Self-contained",id:"self-contained",level:3},{value:"Scalability",id:"scalability",level:3},{value:"Resiliency",id:"resiliency",level:3},{value:"We don&#39;t trust external services",id:"we-dont-trust-external-services",level:3}],p={toc:u};function d(e){let{components:n,...r}=e;return(0,s.kt)("wrapper",(0,t.Z)({},p,r,{components:n,mdxType:"MDXLayout"}),(0,s.kt)("h1",{id:"architecture-overview"},"Architecture Overview"),(0,s.kt)("p",null,"nBold is a multi-tier platform that relies on ",(0,s.kt)("a",{parentName:"p",href:"./references/services-reference"},"independent services")," to support high-availability and scale with ease."),(0,s.kt)("h2",{id:"core-components"},"Core components"),(0,s.kt)("p",null,"At a glance, a basic and minimal nBold production environment (without operations/monitoring tools) would be comprised of these different elements:"),(0,s.kt)(i.G,{chart:"graph TB\n\n    %% Nodes\n\n    teams(Microsoft Teams client<br />Desktop, web, mobile)\n    apps(3rd-party apps<br />Custom, Power Automate)\n    webnlb(SSL, Web Proxy / NLB / Firewall<br />Azure Front Door)\n    subgraph webtier[Web pool]\n        web1(Web #1<br />Azure Container)\n        web2(Web #2<br />Azure Container)\n    end\n    subgraph apitier[Api pool]\n        api1(Api #1<br />Azure Container)\n        api2(Api #2<br />Azure Container)\n    end\n    subgraph jobstier[Jobs pool]\n        scheduler(Scheduler<br />Azure Container)\n        jobs1(Job #1<br />Azure Container)\n        jobs2(Job #2<br />Azure Container)\n    end\n    subgraph ectier[Events pool]\n        ec1(Event Collector #1<br />Azure Container)\n        ec2(Event Collector #2<br />Azure Container)\n    end\n    backingservicesnlb(NLB<br />Azure NLB)\n    subgraph backingservices[ ]\n        redis[(Cache and jobs queuing<br />Azure Cache for Redis)]\n        postgresmain[(Configuration database<br />Azure Database for PostgreSQL)]\n        postgresevents[(Audit database<br />Azure Database for PostgreSQL)]\n        azurestorage[(Blob storage<br />Azure Storage)]\n        cosmosdb[(NoSQL database<br />Azure Cosmos DB)]\n    end\n    \n    %% Links\n\n    teams --\x3e|OAuth/AD| webnlb\n    apps --\x3e|OAuth/AD| webnlb\n\n    backingservicesnlb --\x3e redis \n    backingservicesnlb --\x3e postgresmain \n    backingservicesnlb --\x3e ec1\n    backingservicesnlb --\x3e ec2\n    ec1 --\x3e postgresevents\n    ec2 --\x3e postgresevents\n    backingservicesnlb --\x3e azurestorage\n    backingservicesnlb --\x3e cosmosdb\n\n    web1 --\x3e backingservicesnlb\n    web2 --\x3e backingservicesnlb\n\n    api1 --\x3e backingservicesnlb\n    api2 --\x3e backingservicesnlb\n\n    webnlb --\x3e web1\n    webnlb --\x3e web2\n    webnlb --\x3e api1\n    webnlb --\x3e api2\n\n    jobs1 --\x3e backingservicesnlb\n    jobs2 --\x3e backingservicesnlb\n\n    scheduler --\x3e backingservicesnlb\n    scheduler --\x3e|schedule| jobs1\n    scheduler --\x3e|schedule| jobs2\n\n    %% Styles\n\n    classDef external fill:#9099d8, stroke-width:0px;\n        class teams external\n        class apps external\n    classDef network fill:#90EE90, stroke-width:0px;\n        class net network\n        class backingservicesnlb network\n        class apinlb network\n        class webnlb network\n    classDef containers fill:#ADD8E6, stroke-width:0px;\n        class web1 containers\n        class web2 containers\n        class api1 containers\n        class api2 containers\n        class jobs1 containers\n        class jobs2 containers\n        class scheduler containers\n        class ec1 containers\n        class ec2 containers\n    classDef azureservices fill:#FFFFE0, stroke:#000000, stroke-width:1px;\n        class redis azureservices\n        class postgresmain azureservices\n        class postgresevents azureservices\n        class azurestorage azureservices\n        class cosmosdb azureservices",mdxType:"Mermaid"}),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Legend:")),(0,s.kt)(i.G,{chart:"graph TB\n    ext(Client)\n    net(Network component)\n    cont(OCI / Docker container)\n    az(Managed Azure service)\n\n    classDef external fill:#9099d8, stroke-width:0px;\n        class ext external\n    classDef network fill:#90EE90, stroke-width:0px;\n        class net network\n    classDef containers fill:#ADD8E6, stroke-width:0px;\n        class cont containers\n    classDef azureservices fill:#FFFFE0, stroke-width:0px;\n        class az azureservices",mdxType:"Mermaid"}),(0,s.kt)("p",null,"Notes:"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Azure containers could be hosted on either ",(0,s.kt)("inlineCode",{parentName:"li"},"Azure App Service")," or ",(0,s.kt)("inlineCode",{parentName:"li"},"Azure Container Instances")),(0,s.kt)("li",{parentName:"ul"},"Deployment could be executed manually, using our Terraform ",(0,s.kt)("a",{parentName:"li",href:"./installation/azure-deployment"},"deployment project templates")," for Azure, or using any orchestrator such as ",(0,s.kt)("a",{parentName:"li",href:"https://azure.microsoft.com/en-us/services/kubernetes-service/"},"Azure Kubernetes Service (AKS)"),".")),(0,s.kt)("h2",{id:"monitoring-components"},"Monitoring components"),(0,s.kt)("p",null,"In addition to the previous architecture diagram, here we're presenting the most common additional operations services, for auditing, uptime monitoring and APM (Application Performance Management):"),(0,s.kt)(i.G,{chart:"graph BT\n\n    %% Nodes\n\n    subgraph backingservices[ ]\n        redis(Cache and jobs queuing<br />Azure Cache for Redis)\n        postgresmain(Configuration database<br />Azure Database for PostgreSQL)\n        postgresevents(Audit database<br />Azure Database for PostgreSQL)\n    end\n\n    uptime(Uptime monitoring<br />Monika)\n\n    apptiers(Web, Api and Jobs pools<br />Azure Container)\n\n    redis(Cache and jobs queuing<br />Azure Cache for Redis)\n    redisexporter(Redis exporter<br />Azure Container)\n\n    bullexporter(Bull exporter<br />Azure Container)\n\n    pgexporter(PostgreSQL exporter<br />Azure Container)\n\n    metrics(Metrics collector<br />Prometheus on Azure Container)\n    metricsdashboard(Metrics Dashboard<br />Grafana on Azure Container)\n    apmdashboard(APM Dashboard<br />Azure Application Insights)\n\n    %% Links\n    metrics --\x3e metricsdashboard\n\n    uptime --\x3e apptiers\n    uptime --\x3e metrics\n\n    apptiers --\x3e metrics\n    apptiers --\x3e apmdashboard\n\n    redis --\x3e redisexporter\n    redis --\x3e bullexporter\n    redisexporter --\x3e metrics\n    bullexporter --\x3e metrics\n\n    postgresmain --\x3e pgexporter\n    postgresevents --\x3e pgexporter\n    pgexporter --\x3e metrics\n\n\n    %% Styles\n\n    classDef containers fill:#ADD8E6, stroke-width:0px;\n        class apptiers containers\n        class redisexporter containers\n        class bullexporter containers\n        class pgexporter containers\n        class uptime containers\n        class metrics containers\n        class metricsdashboard containers\n    classDef azureservices fill:#FFFFE0, stroke-width:0px;\n        class apmdashboard azureservices\n        class appinsights azureservices\n        class redis azureservices\n        class postgresmain azureservices\n        class postgresevents azureservices",mdxType:"Mermaid"}),(0,s.kt)("admonition",{type:"tip"},(0,s.kt)("p",{parentName:"admonition"},"Learn more out how to operate a nBold infrastructure using our operations manual, especially ",(0,s.kt)("a",{parentName:"p",href:"./updating"},"Updates management")," and ",(0,s.kt)("a",{parentName:"p",href:"./monitoring"},"monitoring"))),(0,s.kt)("h2",{id:"design-principles"},"Design Principles"),(0,s.kt)("p",null,"Here are the key tenets that drived the design of this architecture."),(0,s.kt)("h3",{id:"security-first"},"Security first"),(0,s.kt)("p",null,"We're enforcing maximum security at each level by applying zero-trust, even if it implies to perform advanced and complex technical operations."),(0,s.kt)("h3",{id:"infrastructure-as-code"},"Infrastructure as code"),(0,s.kt)("p",null,"All our infrastructure resources are defined by code, using the Terraform ",(0,s.kt)("a",{parentName:"p",href:"https://www.terraform.io/docs/language/syntax/configuration.html"},"HCL")," language from ",(0,s.kt)("a",{parentName:"p",href:"https://www.hashicorp.com/"},"HashiCorp"),", resulting in a consistent, reliable and controlled deployment process."),(0,s.kt)("h3",{id:"self-contained"},"Self-contained"),(0,s.kt)("p",null,"To guarantee data residency, the platform could be operated in a fully self-contained environment that doesn't rely on any external service. Technically, the solution could be executed in one single isolated Docker environment."),(0,s.kt)("h3",{id:"scalability"},"Scalability"),(0,s.kt)("p",null,"As a multi-tier platform, each tier (web, api, jobs...) could scale horizontally independently by increasing the number of containers with the same role. In addition, this whole architecture could be replicated across multiple Azure regions to allocate and distribute the workload across multiple environments."),(0,s.kt)("h3",{id:"resiliency"},"Resiliency"),(0,s.kt)("p",null,"All the operations are processed through message queues that brings advanced logging and retry capabilities in case of failure (Throttling, networking issue, Microsoft Graph bugs or unavailability\u2026)."),(0,s.kt)("h3",{id:"we-dont-trust-external-services"},"We don't trust external services"),(0,s.kt)("p",null,"Based on our experience, our design strategy regarding the Microsoft Graph may be summarized in one sentence:\u200b"),(0,s.kt)("blockquote",null,(0,s.kt)("p",{parentName:"blockquote"},"We don\u2019t trust blindly the Microsoft Graph!")))}d.isMDXComponent=!0}}]);