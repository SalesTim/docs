<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Grant consent on behalf of a user | documentation</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/n_degrade-1.svg">
    <link rel="stylesheet" href="/css/bundle.css">
    <script type="text/javascript" src="/js/MicrosoftTeams.min.js"></script>
    <script type="text/javascript" src="/js/theme.js"></script>
    <script type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=UA-5688830-15"></script>
    <script type="text/javascript" src="/js/bundle.js"></script>
    <meta name="description" content="In some organizations, end-users are not permitted to consent to permissions requested by an app like ours.
In this article, you&#39;ll learn how you can, as an administrator, grant consent to specific users on their behalf.">
    <meta name="twitter:title" content="Grant consent on behalf of a user">
    <meta name="twitter:description" content="In some organizations, end-users are not permitted to consent to permissions requested by an app like ours.
In this article, you&#39;ll learn how you can, as an administrator, grant consent to specific users on their behalf.">
    <meta name="twitter:card" content="summary">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Grant consent on behalf of a user">
    <meta property="og:description" content="In some organizations, end-users are not permitted to consent to permissions requested by an app like ours.
In this article, you&#39;ll learn how you can, as an administrator, grant consent to specific users on their behalf.">
    <meta itemprop="name" content="Grant consent on behalf of a user">
    <meta itemprop="description" content="In some organizations, end-users are not permitted to consent to permissions requested by an app like ours.
In this article, you&#39;ll learn how you can, as an administrator, grant consent to specific users on their behalf.">
    
    <link rel="preload" href="/assets/css/0.styles.9ccb3819.css" as="style"><link rel="preload" href="/assets/js/app.22885ca7.js" as="script"><link rel="preload" href="/assets/js/2.1a84a040.js" as="script"><link rel="preload" href="/assets/js/196.ba9711b1.js" as="script"><link rel="prefetch" href="/assets/js/10.a2ce6093.js"><link rel="prefetch" href="/assets/js/100.9daad112.js"><link rel="prefetch" href="/assets/js/101.0513d9a5.js"><link rel="prefetch" href="/assets/js/102.e9b5a74f.js"><link rel="prefetch" href="/assets/js/103.6c0a0007.js"><link rel="prefetch" href="/assets/js/104.336a61ea.js"><link rel="prefetch" href="/assets/js/105.82dce4b2.js"><link rel="prefetch" href="/assets/js/106.7a3546bd.js"><link rel="prefetch" href="/assets/js/107.c2d977d6.js"><link rel="prefetch" href="/assets/js/108.7f172347.js"><link rel="prefetch" href="/assets/js/109.f3a940a1.js"><link rel="prefetch" href="/assets/js/11.1776b28b.js"><link rel="prefetch" href="/assets/js/110.6b37a17b.js"><link rel="prefetch" href="/assets/js/111.33de6609.js"><link rel="prefetch" href="/assets/js/112.1993de77.js"><link rel="prefetch" href="/assets/js/113.3bf2f4a6.js"><link rel="prefetch" href="/assets/js/114.b4d42e88.js"><link rel="prefetch" href="/assets/js/115.9d04c122.js"><link rel="prefetch" href="/assets/js/116.8b7cf7d2.js"><link rel="prefetch" href="/assets/js/117.3433ee55.js"><link rel="prefetch" href="/assets/js/118.27136c92.js"><link rel="prefetch" href="/assets/js/119.2daf4444.js"><link rel="prefetch" href="/assets/js/12.d0f690b6.js"><link rel="prefetch" href="/assets/js/120.a3e80dc3.js"><link rel="prefetch" href="/assets/js/121.bd524348.js"><link rel="prefetch" href="/assets/js/122.878bc266.js"><link rel="prefetch" href="/assets/js/123.1c718b64.js"><link rel="prefetch" href="/assets/js/124.7fddb743.js"><link rel="prefetch" href="/assets/js/125.c9ce2634.js"><link rel="prefetch" href="/assets/js/126.9ade6c6e.js"><link rel="prefetch" href="/assets/js/127.e39756d9.js"><link rel="prefetch" href="/assets/js/128.579d6f16.js"><link rel="prefetch" href="/assets/js/129.d1480148.js"><link rel="prefetch" href="/assets/js/13.0dd02966.js"><link rel="prefetch" href="/assets/js/130.d5b35797.js"><link rel="prefetch" href="/assets/js/131.ad84b1d4.js"><link rel="prefetch" href="/assets/js/132.584045bd.js"><link rel="prefetch" href="/assets/js/133.fc8f65cb.js"><link rel="prefetch" href="/assets/js/134.31cacb23.js"><link rel="prefetch" href="/assets/js/135.3fbfe96f.js"><link rel="prefetch" href="/assets/js/136.8c6e4205.js"><link rel="prefetch" href="/assets/js/137.047a33d6.js"><link rel="prefetch" href="/assets/js/138.8da792d3.js"><link rel="prefetch" href="/assets/js/139.93b71d16.js"><link rel="prefetch" href="/assets/js/14.baea6f6f.js"><link rel="prefetch" href="/assets/js/140.ceb49f99.js"><link rel="prefetch" href="/assets/js/141.20dbc311.js"><link rel="prefetch" href="/assets/js/142.1e63a77f.js"><link rel="prefetch" href="/assets/js/143.da90eb4e.js"><link rel="prefetch" href="/assets/js/144.e8381ae9.js"><link rel="prefetch" href="/assets/js/145.4ea2551b.js"><link rel="prefetch" href="/assets/js/146.c6eb11c6.js"><link rel="prefetch" href="/assets/js/147.b8eaf035.js"><link rel="prefetch" href="/assets/js/148.5de2718a.js"><link rel="prefetch" href="/assets/js/149.31ff03e0.js"><link rel="prefetch" href="/assets/js/15.4d25d5da.js"><link rel="prefetch" href="/assets/js/150.8bef0adf.js"><link rel="prefetch" href="/assets/js/151.0a41eaff.js"><link rel="prefetch" href="/assets/js/152.cef7ff5f.js"><link rel="prefetch" href="/assets/js/153.1346a373.js"><link rel="prefetch" href="/assets/js/154.9ad6a5f9.js"><link rel="prefetch" href="/assets/js/155.d036f306.js"><link rel="prefetch" href="/assets/js/156.0084f0bf.js"><link rel="prefetch" href="/assets/js/157.b35e0c80.js"><link rel="prefetch" href="/assets/js/158.9b947283.js"><link rel="prefetch" href="/assets/js/159.7e649f7c.js"><link rel="prefetch" href="/assets/js/16.7c01e0fc.js"><link rel="prefetch" href="/assets/js/160.ba340d33.js"><link rel="prefetch" href="/assets/js/161.285b3c2a.js"><link rel="prefetch" href="/assets/js/162.d823825e.js"><link rel="prefetch" href="/assets/js/163.68d8a7f8.js"><link rel="prefetch" href="/assets/js/164.bb3f9d1a.js"><link rel="prefetch" href="/assets/js/165.984656bd.js"><link rel="prefetch" href="/assets/js/166.82cc1365.js"><link rel="prefetch" href="/assets/js/167.f3e8fe48.js"><link rel="prefetch" href="/assets/js/168.3ac0248e.js"><link rel="prefetch" href="/assets/js/169.39897ead.js"><link rel="prefetch" href="/assets/js/17.b43c4b30.js"><link rel="prefetch" href="/assets/js/170.3cd02512.js"><link rel="prefetch" href="/assets/js/171.a0c5419a.js"><link rel="prefetch" href="/assets/js/172.009639f1.js"><link rel="prefetch" href="/assets/js/173.242905b3.js"><link rel="prefetch" href="/assets/js/174.956229a0.js"><link rel="prefetch" href="/assets/js/175.8c2ed96c.js"><link rel="prefetch" href="/assets/js/176.45175845.js"><link rel="prefetch" href="/assets/js/177.504f474c.js"><link rel="prefetch" href="/assets/js/178.0eb52c7b.js"><link rel="prefetch" href="/assets/js/179.9bc184cd.js"><link rel="prefetch" href="/assets/js/18.d794c41b.js"><link rel="prefetch" href="/assets/js/180.d6c60fe3.js"><link rel="prefetch" href="/assets/js/181.e8829923.js"><link rel="prefetch" href="/assets/js/182.be64ea35.js"><link rel="prefetch" href="/assets/js/183.81b3d59c.js"><link rel="prefetch" href="/assets/js/184.edf21329.js"><link rel="prefetch" href="/assets/js/185.b557da4b.js"><link rel="prefetch" href="/assets/js/186.7babc674.js"><link rel="prefetch" href="/assets/js/187.7f22a85b.js"><link rel="prefetch" href="/assets/js/188.7f040c0e.js"><link rel="prefetch" href="/assets/js/189.e406d487.js"><link rel="prefetch" href="/assets/js/19.18bd1bae.js"><link rel="prefetch" href="/assets/js/190.277b8210.js"><link rel="prefetch" href="/assets/js/191.32fc2fc2.js"><link rel="prefetch" href="/assets/js/192.9b411fcd.js"><link rel="prefetch" href="/assets/js/193.d5b603b3.js"><link rel="prefetch" href="/assets/js/194.5f15efe1.js"><link rel="prefetch" href="/assets/js/195.8c4e2c88.js"><link rel="prefetch" href="/assets/js/197.d5393ed0.js"><link rel="prefetch" href="/assets/js/198.60b62072.js"><link rel="prefetch" href="/assets/js/199.af92928a.js"><link rel="prefetch" href="/assets/js/20.a5b10754.js"><link rel="prefetch" href="/assets/js/200.a3d894e7.js"><link rel="prefetch" href="/assets/js/201.e9d200b0.js"><link rel="prefetch" href="/assets/js/202.ebcce412.js"><link rel="prefetch" href="/assets/js/203.84968157.js"><link rel="prefetch" href="/assets/js/204.dc71655e.js"><link rel="prefetch" href="/assets/js/205.75e84d9b.js"><link rel="prefetch" href="/assets/js/206.6037984e.js"><link rel="prefetch" href="/assets/js/207.7ba135a4.js"><link rel="prefetch" href="/assets/js/208.7974c9a3.js"><link rel="prefetch" href="/assets/js/209.18092739.js"><link rel="prefetch" href="/assets/js/21.19419a26.js"><link rel="prefetch" href="/assets/js/210.9dc80779.js"><link rel="prefetch" href="/assets/js/211.27b94875.js"><link rel="prefetch" href="/assets/js/212.2714dd56.js"><link rel="prefetch" href="/assets/js/213.62491921.js"><link rel="prefetch" href="/assets/js/214.dc01d3b0.js"><link rel="prefetch" href="/assets/js/215.c00f0db1.js"><link rel="prefetch" href="/assets/js/216.ed169cd8.js"><link rel="prefetch" href="/assets/js/217.d89eaf03.js"><link rel="prefetch" href="/assets/js/218.77171003.js"><link rel="prefetch" href="/assets/js/219.479ddd00.js"><link rel="prefetch" href="/assets/js/22.164cfb3f.js"><link rel="prefetch" href="/assets/js/220.0d9ece81.js"><link rel="prefetch" href="/assets/js/221.6f35c5dc.js"><link rel="prefetch" href="/assets/js/222.5389e73f.js"><link rel="prefetch" href="/assets/js/223.d3c8bce6.js"><link rel="prefetch" href="/assets/js/224.d962c1e1.js"><link rel="prefetch" href="/assets/js/225.7db380e5.js"><link rel="prefetch" href="/assets/js/226.369ca373.js"><link rel="prefetch" href="/assets/js/227.7439d25c.js"><link rel="prefetch" href="/assets/js/228.2f002c12.js"><link rel="prefetch" href="/assets/js/229.53a2e645.js"><link rel="prefetch" href="/assets/js/23.8b9a0116.js"><link rel="prefetch" href="/assets/js/230.62d4bf98.js"><link rel="prefetch" href="/assets/js/231.b2df04b1.js"><link rel="prefetch" href="/assets/js/232.34949a40.js"><link rel="prefetch" href="/assets/js/233.45e56c66.js"><link rel="prefetch" href="/assets/js/234.3feed23b.js"><link rel="prefetch" href="/assets/js/235.494e64b1.js"><link rel="prefetch" href="/assets/js/236.d443d7c8.js"><link rel="prefetch" href="/assets/js/237.61a4c4cc.js"><link rel="prefetch" href="/assets/js/238.32b1eca3.js"><link rel="prefetch" href="/assets/js/239.5bfa4015.js"><link rel="prefetch" href="/assets/js/24.5f593ca7.js"><link rel="prefetch" href="/assets/js/240.634a22c6.js"><link rel="prefetch" href="/assets/js/241.7791f0c5.js"><link rel="prefetch" href="/assets/js/25.dad2ab1e.js"><link rel="prefetch" href="/assets/js/26.28f452fc.js"><link rel="prefetch" href="/assets/js/27.741da4e9.js"><link rel="prefetch" href="/assets/js/28.fef4fbbd.js"><link rel="prefetch" href="/assets/js/29.694cb1cf.js"><link rel="prefetch" href="/assets/js/3.69ca2420.js"><link rel="prefetch" href="/assets/js/30.ebc88bb3.js"><link rel="prefetch" href="/assets/js/31.81519387.js"><link rel="prefetch" href="/assets/js/32.8205490b.js"><link rel="prefetch" href="/assets/js/33.cede44d6.js"><link rel="prefetch" href="/assets/js/34.644bc269.js"><link rel="prefetch" href="/assets/js/35.b81cd6cc.js"><link rel="prefetch" href="/assets/js/36.f35a1a00.js"><link rel="prefetch" href="/assets/js/37.585beaa9.js"><link rel="prefetch" href="/assets/js/38.7343bf1e.js"><link rel="prefetch" href="/assets/js/39.07fa99fb.js"><link rel="prefetch" href="/assets/js/4.89f44406.js"><link rel="prefetch" href="/assets/js/40.a965ffbe.js"><link rel="prefetch" href="/assets/js/41.85f8bae3.js"><link rel="prefetch" href="/assets/js/42.1d12808d.js"><link rel="prefetch" href="/assets/js/43.812d172a.js"><link rel="prefetch" href="/assets/js/44.079cc916.js"><link rel="prefetch" href="/assets/js/45.4c932f63.js"><link rel="prefetch" href="/assets/js/46.0606a006.js"><link rel="prefetch" href="/assets/js/47.7e7fa2b7.js"><link rel="prefetch" href="/assets/js/48.9e3567d3.js"><link rel="prefetch" href="/assets/js/49.d825c665.js"><link rel="prefetch" href="/assets/js/5.4e907daa.js"><link rel="prefetch" href="/assets/js/50.c85473f8.js"><link rel="prefetch" href="/assets/js/51.d3dea0ff.js"><link rel="prefetch" href="/assets/js/52.74fe1837.js"><link rel="prefetch" href="/assets/js/53.9dc8d526.js"><link rel="prefetch" href="/assets/js/54.ed3a9714.js"><link rel="prefetch" href="/assets/js/55.1292d347.js"><link rel="prefetch" href="/assets/js/56.6ca1a82c.js"><link rel="prefetch" href="/assets/js/57.8b16ecf3.js"><link rel="prefetch" href="/assets/js/58.8845653f.js"><link rel="prefetch" href="/assets/js/59.eda3f3f9.js"><link rel="prefetch" href="/assets/js/6.d738230e.js"><link rel="prefetch" href="/assets/js/60.6f8fcfb0.js"><link rel="prefetch" href="/assets/js/61.9e8a3994.js"><link rel="prefetch" href="/assets/js/62.c745197a.js"><link rel="prefetch" href="/assets/js/63.4009e2ec.js"><link rel="prefetch" href="/assets/js/64.d9aa6803.js"><link rel="prefetch" href="/assets/js/65.2bec85c3.js"><link rel="prefetch" href="/assets/js/66.ff8debfc.js"><link rel="prefetch" href="/assets/js/67.eaca6739.js"><link rel="prefetch" href="/assets/js/68.46055b53.js"><link rel="prefetch" href="/assets/js/69.beaaeb9d.js"><link rel="prefetch" href="/assets/js/7.77ac1ead.js"><link rel="prefetch" href="/assets/js/70.d0dbc6e4.js"><link rel="prefetch" href="/assets/js/71.b2d68d16.js"><link rel="prefetch" href="/assets/js/72.892106f0.js"><link rel="prefetch" href="/assets/js/73.92cb7ece.js"><link rel="prefetch" href="/assets/js/74.76d3f321.js"><link rel="prefetch" href="/assets/js/75.449a0577.js"><link rel="prefetch" href="/assets/js/76.f6d08615.js"><link rel="prefetch" href="/assets/js/77.e2a43a96.js"><link rel="prefetch" href="/assets/js/78.11cb0cca.js"><link rel="prefetch" href="/assets/js/79.b8a704ed.js"><link rel="prefetch" href="/assets/js/8.82275554.js"><link rel="prefetch" href="/assets/js/80.2c0955cd.js"><link rel="prefetch" href="/assets/js/81.d0d51a3f.js"><link rel="prefetch" href="/assets/js/82.5aaf46f6.js"><link rel="prefetch" href="/assets/js/83.bf162c01.js"><link rel="prefetch" href="/assets/js/84.d9d2810f.js"><link rel="prefetch" href="/assets/js/85.9cfd1139.js"><link rel="prefetch" href="/assets/js/86.f6d9d186.js"><link rel="prefetch" href="/assets/js/87.fc5b7912.js"><link rel="prefetch" href="/assets/js/88.b57cebb9.js"><link rel="prefetch" href="/assets/js/89.e713bf64.js"><link rel="prefetch" href="/assets/js/9.e9e4c73d.js"><link rel="prefetch" href="/assets/js/90.24efbdc5.js"><link rel="prefetch" href="/assets/js/91.e5cec622.js"><link rel="prefetch" href="/assets/js/92.66734e69.js"><link rel="prefetch" href="/assets/js/93.252e52af.js"><link rel="prefetch" href="/assets/js/94.7eefa2b5.js"><link rel="prefetch" href="/assets/js/95.fa3d14e4.js"><link rel="prefetch" href="/assets/js/96.ebad916e.js"><link rel="prefetch" href="/assets/js/97.772c51d1.js"><link rel="prefetch" href="/assets/js/98.5ca950d2.js"><link rel="prefetch" href="/assets/js/99.be17f2be.js">
    <link rel="stylesheet" href="/assets/css/0.styles.9ccb3819.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/Logo_degrade_noir@4x.png" alt="documentation" class="logo"> <span class="site-name can-hide">documentation</span></a> <div class="links"><!----> <div class="user-settings"><a href="#" class="settings-button"><svg aria-hidden="true" data-prefix="fas" data-icon="cog" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="svg-inline--fa fa-cog fa-w-16 settings-icon"><path fill="currentColor" d="M444.788 291.1l42.616 24.599c4.867 2.809 7.126 8.618 5.459 13.985-11.07 35.642-29.97 67.842-54.689 94.586a12.016 12.016 0 0 1-14.832 2.254l-42.584-24.595a191.577 191.577 0 0 1-60.759 35.13v49.182a12.01 12.01 0 0 1-9.377 11.718c-34.956 7.85-72.499 8.256-109.219.007-5.49-1.233-9.403-6.096-9.403-11.723v-49.184a191.555 191.555 0 0 1-60.759-35.13l-42.584 24.595a12.016 12.016 0 0 1-14.832-2.254c-24.718-26.744-43.619-58.944-54.689-94.586-1.667-5.366.592-11.175 5.459-13.985L67.212 291.1a193.48 193.48 0 0 1 0-70.199l-42.616-24.599c-4.867-2.809-7.126-8.618-5.459-13.985 11.07-35.642 29.97-67.842 54.689-94.586a12.016 12.016 0 0 1 14.832-2.254l42.584 24.595a191.577 191.577 0 0 1 60.759-35.13V25.759a12.01 12.01 0 0 1 9.377-11.718c34.956-7.85 72.499-8.256 109.219-.007 5.49 1.233 9.403 6.096 9.403 11.723v49.184a191.555 191.555 0 0 1 60.759 35.13l42.584-24.595a12.016 12.016 0 0 1 14.832 2.254c24.718 26.744 43.619 58.944 54.689 94.586 1.667 5.366-.592 11.175-5.459 13.985L444.788 220.9a193.485 193.485 0 0 1 0 70.2zM336 256c0-44.112-35.888-80-80-80s-80 35.888-80 80 35.888 80 80 80 80-35.888 80-80z"></path></svg></a> <div class="user-settings-menu" style="display:none;"><div class="theme-options"><!----> <ul class="color-theme-options"><li><a href="#" class="default-theme"></a></li> <li><a href="#" class="blue-theme"></a></li><li><a href="#" class="red-theme"></a></li><li><a href="#" class="purple-theme"></a></li></ul> <div class="dark-theme-options toggle-option"><label for="dark-theme-toggle">🌗 Dark Theme</label> <input id="dark-theme-toggle" type="checkbox"></div> <!----> <!----></div></div></div> <!----> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Automation" class="dropdown-title"><span class="title">🚀 Automation</span> <span class="arrow down"></span></button> <button type="button" aria-label="Automation" class="mobile-dropdown-title"><span class="title">🚀 Automation</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/automation/power-platform-automation-connector.html" class="nav-link">
  Power Platform
</a></li><li class="dropdown-item"><!----> <a href="/automation/logic-apps-automation-connector.html" class="nav-link">
  Logic Apps
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Developers" class="dropdown-title"><span class="title">&gt;_ Developers</span> <span class="arrow down"></span></button> <button type="button" aria-label="Developers" class="mobile-dropdown-title"><span class="title">&gt;_ Developers</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/api/get-started.html" class="nav-link">
  Get started
</a></li><li class="dropdown-item"><!----> <a href="/api/explorer.html" class="nav-link">
  API Explorer
</a></li><li class="dropdown-item"><!----> <a href="/api/latest/reference/" class="nav-link">
  API Reference
</a></li></ul></div></div><div class="nav-item"><a href="/trust-center/" class="nav-link">
  🔐 Trust Center
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="More" class="dropdown-title"><span class="title">🌐 More</span> <span class="arrow down"></span></button> <button type="button" aria-label="More" class="mobile-dropdown-title"><span class="title">🌐 More</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://nbold.co" target="_blank" rel="noopener noreferrer" class="nav-link external">
  nBold
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.linkedin.com/company/nbold" target="_blank" rel="noopener noreferrer" class="nav-link external">
  LinkedIn
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://twitter.com/nboldco" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Twitter
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.youtube.com/channel/UCyoESYiKzmIdVbR7BHu0cbQ" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Youtube
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Automation" class="dropdown-title"><span class="title">🚀 Automation</span> <span class="arrow down"></span></button> <button type="button" aria-label="Automation" class="mobile-dropdown-title"><span class="title">🚀 Automation</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/automation/power-platform-automation-connector.html" class="nav-link">
  Power Platform
</a></li><li class="dropdown-item"><!----> <a href="/automation/logic-apps-automation-connector.html" class="nav-link">
  Logic Apps
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Developers" class="dropdown-title"><span class="title">&gt;_ Developers</span> <span class="arrow down"></span></button> <button type="button" aria-label="Developers" class="mobile-dropdown-title"><span class="title">&gt;_ Developers</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/api/get-started.html" class="nav-link">
  Get started
</a></li><li class="dropdown-item"><!----> <a href="/api/explorer.html" class="nav-link">
  API Explorer
</a></li><li class="dropdown-item"><!----> <a href="/api/latest/reference/" class="nav-link">
  API Reference
</a></li></ul></div></div><div class="nav-item"><a href="/trust-center/" class="nav-link">
  🔐 Trust Center
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="More" class="dropdown-title"><span class="title">🌐 More</span> <span class="arrow down"></span></button> <button type="button" aria-label="More" class="mobile-dropdown-title"><span class="title">🌐 More</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://nbold.co" target="_blank" rel="noopener noreferrer" class="nav-link external">
  nBold
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.linkedin.com/company/nbold" target="_blank" rel="noopener noreferrer" class="nav-link external">
  LinkedIn
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://twitter.com/nboldco" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Twitter
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.youtube.com/channel/UCyoESYiKzmIdVbR7BHu0cbQ" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Youtube
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/hosting/" aria-current="page" class="sidebar-link">About</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Installation</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Advanced</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/hosting/advanced/grant-consent-on-behalf-of-a-user.html" aria-current="page" class="active sidebar-link">Grant consent on-behalf</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/hosting/advanced/grant-consent-on-behalf-of-a-user.html#abstract" class="sidebar-link">Abstract</a></li><li class="sidebar-sub-header"><a href="/hosting/advanced/grant-consent-on-behalf-of-a-user.html#what-happens-when-consent-is-granted" class="sidebar-link">What happens when consent is granted?</a></li><li class="sidebar-sub-header"><a href="/hosting/advanced/grant-consent-on-behalf-of-a-user.html#prerequisites" class="sidebar-link">Prerequisites</a></li><li class="sidebar-sub-header"><a href="/hosting/advanced/grant-consent-on-behalf-of-a-user.html#powershell-script" class="sidebar-link">PowerShell script</a></li></ul></li><li><a href="/hosting/advanced/monitoring.html" class="sidebar-link">Monitoring</a></li><li><a href="/hosting/advanced/updating.html" class="sidebar-link">Updating</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Concepts</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>References</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="grant-consent-on-behalf-of-a-user"><a href="#grant-consent-on-behalf-of-a-user" class="header-anchor">#</a> Grant consent on behalf of a user</h1> <hr> <p><strong>TABLE OF CONTENTS</strong></p><div class="table-of-contents"><ul><li><a href="#abstract">Abstract</a></li><li><a href="#what-happens-when-consent-is-granted">What happens when consent is granted?</a></li><li><a href="#prerequisites">Prerequisites</a></li><li><a href="#powershell-script">PowerShell script</a></li></ul></div><p></p> <hr> <h2 id="abstract"><a href="#abstract" class="header-anchor">#</a> Abstract</h2> <p>In some organizations, end-users are not permitted to consent to permissions requested by an app like ours.
In this article, you'll learn how you can, as an administrator, grant consent to specific users on their behalf.</p> <h2 id="what-happens-when-consent-is-granted"><a href="#what-happens-when-consent-is-granted" class="header-anchor">#</a> What happens when consent is granted?</h2> <p>When a user grants consent on his or her own behalf, the following events occur:</p> <ul><li>A service principal for the client application is created, if it doesn't already exist. A service principal is the instance of an application or a service in your Azure Active Directory (Azure AD) tenant. Access that's granted to the app or service is associated with this service principal object.</li> <li>For each API to which the application requires access, a delegated permission grant to that API is created for the permissions that are needed by the application, for access on behalf of the user. A delegated permission grant authorizes an application to access an API on behalf of a user, when that user has signed in.</li> <li>The user is assigned the client application. Assigning the application to the user ensures that the application is listed in the My Apps portal for that user, which allows them to review and revoke the access that has been granted on their behalf.</li></ul> <h2 id="prerequisites"><a href="#prerequisites" class="header-anchor">#</a> Prerequisites</h2> <p>To grant consent to an application on behalf of one user, you need:</p> <ul><li>A <code>Global Administrator</code> or <code>Privileged Administrator</code> role.</li> <li><a href="https://docs.microsoft.com/en-us/graph/powershell/installation" target="_blank" rel="noopener noreferrer">Microsoft Graph PowerShell SDK<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, that you can install using the <code>Install-Module Microsoft.Graph -Scope CurrentUser</code> PowerShell command.</li></ul> <h2 id="powershell-script"><a href="#powershell-script" class="header-anchor">#</a> PowerShell script</h2> <p>This script has to be executed for each user on behalf of whom access will be granted. It could also easily be adapted to execute these operations in batch.</p> <div class="custom-block tip"><p class="custom-block-title">Note</p> <p>Before you execute this script, retrieve the username or object ID for the user on whose behalf access will be granted from the Azure portal, and update the <code>$userUpnOrId</code> variable.</p></div> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token comment"># -----------------------------------------------------------------------------</span>
<span class="token comment"># Variables</span>
<span class="token comment"># -----------------------------------------------------------------------------</span>

<span class="token comment"># The user on behalf of whom access will be granted. Note: the app will be able to access the API on behalf of this user.</span>
<span class="token variable">$userUpnOrId</span> = <span class="token string">&quot;serviceaccount@example.com&quot;</span>
<span class="token comment"># The app client ID for which consent is being granted (This GUID is the nBold app client ID).</span>
<span class="token variable">$clientAppId</span> = <span class="token string">&quot;2a651f59-97ce-42bb-97d7-cf7a2af4b635&quot;</span>
<span class="token comment"># The API to which access will be granted (Microsoft Graph API) referenced by its ID.</span>
<span class="token variable">$resourceAppId</span> = <span class="token string">&quot;00000003-0000-0000-c000-000000000000&quot;</span>
<span class="token comment"># The permissions to grant.</span>
<span class="token variable">$permissions</span> = @<span class="token punctuation">(</span><span class="token string">&quot;openid&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;offline_access&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;email&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;profile&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;User.ReadBasic.All&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Team.ReadBasic.All&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Channel.ReadBasic.All&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;TeamSettings.Read.All&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;TeamMember.Read.All&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ChannelMember.Read.All&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ChannelSettings.Read.All&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;TeamsTab.Read.All&quot;</span><span class="token punctuation">)</span>

<span class="token comment"># -----------------------------------------------------------------------------</span>
<span class="token comment"># Step 0. Connect to Microsoft Graph PowerShell.</span>
<span class="token comment"># -----------------------------------------------------------------------------</span>

<span class="token comment"># We need User.ReadBasic.All to get</span>
<span class="token comment"># users' IDs, Application.ReadWrite.All to list and create service principals, </span>
<span class="token comment"># DelegatedPermissionGrant.ReadWrite.All to create delegated permission grants, </span>
<span class="token comment"># and AppRoleAssignment.ReadWrite.All to assign an app role.</span>
<span class="token comment"># WARNING: These are high-privilege permissions!</span>
<span class="token function">Connect-MgGraph</span> <span class="token operator">-</span>Scopes <span class="token punctuation">(</span><span class="token string">&quot;User.ReadBasic.All Application.ReadWrite.All &quot;</span> `
                        <span class="token operator">+</span> <span class="token string">&quot;DelegatedPermissionGrant.ReadWrite.All &quot;</span> `
                        <span class="token operator">+</span> <span class="token string">&quot;AppRoleAssignment.ReadWrite.All&quot;</span><span class="token punctuation">)</span>

<span class="token comment"># -----------------------------------------------------------------------------</span>
<span class="token comment"># Step 1. Check if a service principal exists for the client application. </span>
<span class="token comment"># -----------------------------------------------------------------------------</span>

<span class="token comment"># If one does not exist, create it.</span>
<span class="token variable">$clientSp</span> = <span class="token function">Get-MgServicePrincipal</span> <span class="token operator">-</span><span class="token keyword">Filter</span> <span class="token string">&quot;appId eq '<span class="token function">$<span class="token punctuation">(</span><span class="token variable">$clientAppId</span><span class="token punctuation">)</span></span>'&quot;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">-not</span> <span class="token variable">$clientSp</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token variable">$clientSp</span> = <span class="token function">New-MgServicePrincipal</span> <span class="token operator">-</span>AppId <span class="token variable">$clientAppId</span>
<span class="token punctuation">}</span>

<span class="token comment"># -----------------------------------------------------------------------------</span>
<span class="token comment"># Step 2. Create a delegated permission that grants the client app access to the</span>
<span class="token comment"># -----------------------------------------------------------------------------</span>

<span class="token comment"># API, on behalf of the user. (This example assumes that an existing delegated </span>
<span class="token comment"># permission grant does not already exist, in which case it would be necessary </span>
<span class="token comment"># to update the existing grant, rather than create a new one.)</span>
<span class="token variable">$user</span> = <span class="token function">Get-MgUser</span> <span class="token operator">-</span>UserId <span class="token variable">$userUpnOrId</span>
<span class="token variable">$resourceSp</span> = <span class="token function">Get-MgServicePrincipal</span> <span class="token operator">-</span><span class="token keyword">Filter</span> <span class="token string">&quot;appId eq '<span class="token function">$<span class="token punctuation">(</span><span class="token variable">$resourceAppId</span><span class="token punctuation">)</span></span>'&quot;</span>
<span class="token variable">$scopeToGrant</span> = <span class="token variable">$permissions</span> <span class="token operator">-join</span> <span class="token string">&quot; &quot;</span>
<span class="token variable">$grant</span> = New-MgOauth2PermissionGrant <span class="token operator">-</span>ResourceId <span class="token variable">$resourceSp</span><span class="token punctuation">.</span>Id `
                                     <span class="token operator">-</span>Scope <span class="token variable">$scopeToGrant</span> `
                                     <span class="token operator">-</span>ClientId <span class="token variable">$clientSp</span><span class="token punctuation">.</span>Id `
                                     <span class="token operator">-</span>ConsentType <span class="token string">&quot;Principal&quot;</span> `
                                     <span class="token operator">-</span>PrincipalId <span class="token variable">$user</span><span class="token punctuation">.</span>Id

<span class="token comment"># -----------------------------------------------------------------------------</span>
<span class="token comment"># Step 3. Assign the app to the user.</span>
<span class="token comment"># -----------------------------------------------------------------------------</span>

<span class="token comment"># This ensures that the user can sign in if assignment is required, and ensures that the app shows up under the user's My Apps.</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$clientSp</span><span class="token punctuation">.</span>AppRoles <span class="token punctuation">|</span> ? <span class="token punctuation">{</span> <span class="token variable">$_</span><span class="token punctuation">.</span>AllowedMemberTypes <span class="token operator">-contains</span> <span class="token string">&quot;User&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">Write-Warning</span> <span class="token punctuation">(</span><span class="token string">&quot;A default app role assignment cannot be created because the &quot;</span> `
                 <span class="token operator">+</span> <span class="token string">&quot;client application exposes user-assignable app roles. You must &quot;</span> `
                 <span class="token operator">+</span> <span class="token string">&quot;assign the user a specific app role for the app to be listed &quot;</span> `
                 <span class="token operator">+</span> <span class="token string">&quot;in the user's My Apps access panel.&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment"># The app role ID 00000000-0000-0000-0000-000000000000 is the default app role</span>
    <span class="token comment"># indicating that the app is assigned to the user, but not for any specific </span>
    <span class="token comment"># app role.</span>
    <span class="token variable">$assignment</span> = <span class="token function">New-MgServicePrincipalAppRoleAssignedTo</span> `
          <span class="token operator">-</span>ServicePrincipalId <span class="token variable">$clientSp</span><span class="token punctuation">.</span>Id `
          <span class="token operator">-</span>ResourceId <span class="token variable">$clientSp</span><span class="token punctuation">.</span>Id `
          <span class="token operator">-</span>PrincipalId <span class="token variable">$user</span><span class="token punctuation">.</span>Id `
          <span class="token operator">-</span>AppRoleId <span class="token string">&quot;00000000-0000-0000-0000-000000000000&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">📅 Last Updated:</span> <span class="time">3/4/2022, 3:16:05 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/hosting/installation/microsoft-teams-package.html" class="prev">
        Microsoft Teams package
      </a></span> <span class="next"><a href="/hosting/advanced/monitoring.html">
        Monitoring
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.22885ca7.js" defer></script><script src="/assets/js/2.1a84a040.js" defer></script><script src="/assets/js/196.ba9711b1.js" defer></script>
  </body>
</html>
